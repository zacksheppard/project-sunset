<!DOCTYPE html>
<html>
<head>

  <!-- Begin javascript from the top of the page.  -->

  <script>
jQuery(document).ready(function(){

    // jQuery('#show-map').click(function(){
    //     jQuery('#map-canvas').toggle();
    // });
    // $(".map-toggle").click(function(){
    //   $(".map").slideToggle();

  function mouseOn(){
    var height = $(this).find('.bottom').height() + 200;
    $('#map-canvas').show();
    $(this).find('.bottom').animate({bottom:height}, 400).fadeTo(200, 1);
    $(this).find('.top').fadeTo(200, .2);
  }

  function mouseOff(){
    $(this).find('.bottom').animate({bottom:200}, 400).fadeTo(200, 0).hide();
    $(this).find('.top').fadeTo(200, 1);
  }

  $('#hover-map').hover(mouseOn,mouseOff);
  // $('#hover2').hover(function(){
  //   $(this).find('.front').fadeTo(200,0.2);
  // },function(){
  //   $(this).find('.front').fadeTo(200,1);
  // });
});
</script>
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>

  <!-- Begin javascript from the bottom of the page.  -->

<script>
  var mapAdded = false
  function displayMap() {
    document.getElementById('map-canvas').style.display="block";
    initialize();
  }

    function initialize() {
      var latitude = <%= @photo.lat %>;
      var longitude = <%= @photo.lon %>;
      var markerTitle = '<%= @photo.location.titleize %>';
      var myLatlng = new google.maps.LatLng(latitude,longitude);
      var mapOptions = {
      zoom: 3,
      center: myLatlng
    }
    var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

    var marker = new google.maps.Marker({
        position: myLatlng,
        map: map,
        title: markerTitle
    });
    mapAdded = true;
    }

    function addMap() {
        google.maps.event.addDomListener(window, 'load', displayMap);
      }

    addMap();

    var check = function(){
      if(mapAdded == true){
        $('#map-canvas').hide();
        console.log("hidden");
      }else{
        setTimeout(check, 500);
        console.log("waiting");
      }
    }
    check();

</script>

  <!-- Begin original head code -->

  <title>ProjectSunset</title>
  <link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
  <%= stylesheet_link_tag    'application', media: 'all' %>
  <%= javascript_include_tag 'application' %>
  <%= csrf_meta_tags %>
  <%= analytics_init if Rails.env.production? %>
</head>
<body>
<div class="wrapper">
<%= yield %>
</div>


</body>
</html>